python medoids_05A.py
[INFO 012]: > Save halton points > File name: scenario_outputs/012_halton_points.png
[INFO 013]: > Save scaled halton points > File name: scenario_outputs/013_halton_points_scaled.png
[INFO 014]: + save scenarios for KMEANS
[INFO 014]: + save scenarios for KMEANS
[INFO 021]: Generating Medoid Anchors
[INFO 021]: Warning! We use uniform weights to avoid over-fitting mass!
[INFO 021]: Pure Medoids only (Anchors): 60
[INFO 031]: Hybrid kmedoids + NN refinement clustering
[INFO 031]: Initial medoid set: 60 reps, max coverage radius = 4.177
[INFO 031]: Hybrid refinement produced 763 representatives; max radius = 1.993
[INFO 031]: Elbow suggests radius ~ 3.513 at refinement step 67 (total reps ~ 127)
[INFO 032]: > Save figure of refinement process > File name: scenario_outputs/032_refinement_process.png
[INFO 034]: Assigning scenarios to nearest medoid anchors via 1-NN
[INFO 034]: Cluster mass stats: min=0.0010 max=0.0640 sum=1.0000
[INFO 033]: > Save figure for cluster comparisons > File name: scenario_outputs/033_cluster_comparison.png
[INFO 035]: Selected total (anchors + extras): 117
[INFO 036]: Saving 117 representatives.
[INFO 036]: + save scenarios for HYBRID-01
[INFO 036]: + save scenarios for HYBRID-01
[INFO 035]: Descriptif Statistics of scenario:
[INFO 037]: Kept medoids: 60, Dropped by design: 0
[INFO 037]: mean NN-dist: 9.9443 | p95: 13.7369
[INFO 041]: > Save figure for comparison cluster > File name: scenario_outputs/041_PCA_2D_comparison_cluster.png
[INFO 052]: Approximation error comparison
[Approx error | weighted NN distance]
  Anchors: mean=10.8896, p95=14.3810
  Hybrid : mean=9.9443, p95=13.7351
[INFO 042]: > Save histogram of approximation error > File name: scenario_outputs/042_Histogram_approximation_error.png
[INFO 043]: Quantitative summary of approximation error reduction 
         Metric Anchors-only Hybrid Improvement (%)
  Weighted mean       10.890  9.944            +8.7
95th percentile       14.381 13.735            +4.5
99th percentile       15.338 14.478            +5.6
[INFO 044]: > Save histogram of probability mass > File name: scenario_outputs/044_Histogram_probability_mass_.png
[INFO 045]: > Save figure of tail coverages > File name: scenario_outputs/045_tail_coverage.png
[INFO 046]:Tail threshold set at the 90th percentile of the FULL ensemble: x ≥ 15.117

        Method KS (sup |ΔF|) ∫|ΔF| dx Wasserstein-1
K-Medoids only        0.8520   2.4299        2.0663
        Hybrid        0.6470   1.7106        1.5354
        Method Tail KS Tail ∫|ΔF| dx Tail W1
K-Medoids only  0.5700        0.5080  0.4532
        Hybrid  0.5626        0.6563  0.7400
[INFO 048]: Hybrid improvement relative to K-Medoids only (positive = better)

       Metric Overall Improvement (%) Tail Improvement (%)
KS (sup |ΔF|)                   +24.1                 +1.3
     ∫|ΔF| dx                   +29.6                -29.2
Wasserstein-1                   +25.7                -63.3
[INFO 048]: Concise improvement summary:
KS (sup |ΔF|): overall +24.1 %, tail +1.3 %
∫|ΔF| dx: overall +29.6 %, tail -29.2 %
Wasserstein-1: overall +25.7 %, tail -63.3 %
/home/aila/clawpack_src/ptha_scenario_medoids/medoids_05A.py:1118: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
  ax[0].set_title("Per-feature weighted mean"); plt.xlabel("Feature index"); plt.legend()
[INFO 051]: > Save figure of per feature comparison > File name: scenario_outputs/051_Per_feature_comparison.png
[INFO 052]: === Summary of feature-wise deviation between Full and Hybrid ===
                           Value
Mean abs. error (mean)     0.121
Mean rel. error % (mean) 139.649
Mean abs. error (95th)     0.667
Mean rel. error % (95th)  15.835
Max rel. error % (mean)  200.000
Max rel. error % (95th)   39.319
 Feature |Δ mean| Rel. error % (mean) |Δ 95th| Rel. error % (95th)
       0    0.148             192.174    1.523              39.319
       1    0.040             173.674    0.267               5.912
       2    0.185             187.370    0.316               7.069
       3    0.136             159.893    1.264              31.722
       4    0.218             180.989    1.394              35.548
       5    0.008              54.454    0.134               2.909
       6    0.014              42.960    0.170               3.721
       7    0.206             151.609    0.561              11.215
       8    0.092             200.000    0.673              15.698
       9    0.258             200.000    1.320              32.116
      10    0.015             131.924    0.716              16.729
      11    0.236             200.000    0.385               8.715
      12    0.124             140.219    0.032               0.690
      13    0.183             173.003    0.934              22.200
      14    0.119              71.467    1.326              32.460
      15    0.250             195.447    0.828              19.191
      16    0.018              37.338    0.688              13.128
      17    0.091             193.891    0.372               8.678
      18    0.011              10.082    0.428               9.433
      19    0.061              96.479    0.011               0.237
[INFO 053]: === Comparison: K-Medoids only vs Hybrid (per-feature mean & tail errors) ===
                 Mean rel. error % (mean)  Mean rel. error % (95th)  Max rel. error % (mean)  Max rel. error % (95th)
K-Medoids only                     153.71                     22.80                   200.00                    54.72
Hybrid                             139.65                     15.83                   200.00                    39.32
Improvement (%)                      9.15                     30.54                      NaN                      NaN
[INFO 054]: === IQR-normalized per-feature deviation: K-Medoids vs Hybrid ===
                           Mean  Median     P90     Max
SMAPE mean (K-Medoids)  153.709 179.274 200.000 200.000
SMAPE mean (Hybrid)     139.649 166.448 200.000 200.000
IQR-norm |Δmean| (K-M)    0.044   0.049   0.075   0.110
IQR-norm |Δmean| (Hybr)   0.032   0.032   0.063   0.067
IQR-norm |Δ95th| (K-M)    0.240   0.247   0.437   0.521
IQR-norm |Δ95th| (Hybr)   0.175   0.160   0.346   0.400
Improvement (Hybrid vs K-Medoids):
  SMAPE(mean): +9.1%
  IQR-norm |Δmean|: +27.6%
  IQR-norm |Δ95th|: +27.1%
  Max improvement (IQR-norm): mean +39.1%, 95th +23.3%
[INFO 055]: TAIL-GUARD Worst tail feature index = 0 (IQR-norm |Δ95th| = 0.400)
[TAIL-GUARD] Proposed extras = 54 per-cluster guard points.
[INFO 056]: TAIL-GUARD -> IQR-norm |Δ95th| summary (all features):
  Mean: before 0.175 → after 0.138  (improvement +21.3%)
  Max : before 0.400 → after 0.343  (improvement +14.2%)
[INFO 056]: TAIL-GUARD-> Feature j*=0: before 0.400 → after 0.158 (improvement +60.5%)
[INFO 056]: + Saving 171 representatives.
[INFO 056]: + Saving 171 representatives.
[INFO 057]: > Save figure of per feature IQR comparison > File name: scenario_outputs/057_Per_feature_IQR_comparison.png
(claw)  GEO  ~/clawpack_src/ptha_scenario_medoids  